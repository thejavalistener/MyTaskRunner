{
  "vars": {
    "Drive": "D:",
    "TempDir": "${Drive}/temp/VSCodeInstall",

    "SoftRepo": "D:/Soft/IDE/VSCode",
    "VSCodeZipFile": "VSCode_v1.9.9.zip",
    "FullProjectZipFile": "AlgoritmosAFondo_FULL_v2.7.27.zip",
    "VSCodeHome": "${Drive}/vscode",
    "VSCodeWorkspace": "${VSCodeHome}/Workspace",
    "BackupWorkspaceFileName":"workspaceBackup_${now:yyyyMMdd-HHmm}.zip"
  },

  "steps": [    
    { "action": "Zip", "from": "${VSCodeWorkspace}","to":"${BackupWorkspaceFileName}" },
    { "action": "MkDir", "path": "${TempDir}" },

    { "action": "Copy", "from": "${SoftRepo}/${VSCodeZipFile}", "to": "${TempDir}/${VSCodeZipFile}", "showProgress": true },
    { "action": "Copy", "from": "${SoftRepo}/${FullProjectZipFile}", "to": "${TempDir}/${FullProjectZipFile}", "showProgress": true },

    { "action": "Remove", "path": "${VSCodeHome}","stopScriptOnError":true },

    { "action": "Unzip", "from": "${TempDir}/${VSCodeZipFile}", "to": "${Drive}/", "showProgress": true },
    { "action": "Unzip", "from": "${TempDir}/${FullProjectZipFile}", "to": "${VSCodeWorkspace}", "showProgress": true },

    { "action": "Remove", "path": "${TempDir}" },

    { "action": "Exec", "command": "${VSCodeHome}/RunVSCode.bat" }
  ]
}
